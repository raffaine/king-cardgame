<!DOCTYPE html>
<html>
    <head>
        <title> King, the card game </title>
        <link href="./cards.css" rel="stylesheet" type="text/css" />
        <link href="./king.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <div id="infobox">
            <span id="infocontent"> </span>
        </div>
        <!-- Header. -->
        <div id="header">
            <button id="console-btn">C</button>
            <button id="start-btn">S</button>
            <h2> King </h2>
        </div>
        
        <!-- Table's area. -->
        <div id="table" class="playingField">
            <div id="tableCards" class="cardArea"></div>
        </div>

        <!-- Main player's area. -->
        <div id="player" class="playingField">
            <div class="textBox name">Player</div>
            <div id="playerScore"  class="textBox">&nbsp;</div>
            <div id="playerCards"  class="cardArea"></div>
        </div>

        <div id="command-panel">
            <ul id="messages"></ul>
            <form action="">
                <input id="m" autocomplete="off" /><button>Go</button>
            </form>
        </div>
        <script src="http://linuxhost-t6r6208s.cloudapp.net:8086/socket.io/socket.io.js"></script>
        <script src="http://code.jquery.com/jquery-3.1.1.js"></script>
        <script src='./jquery.keyframes.js'></script>
        <script src="./cards.js" type="text/javascript"> </script>
        <script src="./king.js" type="text/javascript"></script>
        <script>
            //var socket = io(); // automattically connect with the host serving the page
            // If server is running, I can run this locally!
            var socket = io.connect('http://linuxhost-t6r6208s.cloudapp.net:8086');
            var cur_game = null;

            socket.on('response', function(data) {
                $('#messages').append($('<li>').text('RESPONSE: ' + data));
            });

            socket.on('info', function(msg) {
                $('#messages').append($('<li>').text('INFO: ' + msg).addClass('info'));
            });

            $('form').submit(function(){
                socket.emit('action', $('#m').val());
                $('#m').val('');
                return false;
            });

            $('#console-btn').on('click', function(evt) {
                var elem = $('#command-panel');
                if (elem.hasClass('visible')) {
                    elem.removeClass('visible');
                } else {
                    elem.addClass('visible');
                }
            });

            $('#start-btn').on('click', function(evt){
                if (cur_game === null) {
                    var name = prompt('Enter name:');
                    cur_game = new Game(name);
                    hunt_table(cur_game);
                }
            });

            var hand = $('#playerCards');
            var middle = hand.innerWidth() / 2;

            // Create animations for hand
            for (var i=0; i<13; i++) {
                $.keyframe.define([{
                    name: `handCard${i}`,
                    from: {
                        transform: `translateX(${middle}px)`
                    },
                    to: {
                        transform: `translateX(${2*i}em)`
                    }
                },
                {
                    name: 'playHandCard',
                    from: {
                        transform: `translateX(${2*i}em) translateY(0em)`,
                        opacity: 1,
                        visibility: 'visible'
                    },
                    to: {
                        transform: `translateX(${middle}px) translateY(-10em)`,
                        opacity: 0,
                        visibility: 'hidden'
                    }
                }]);
            }
        </script>
    </body>
</html>